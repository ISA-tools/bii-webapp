{% extends "base.html" %}
{% load widget_tweaks %}
{% load static from staticfiles %}
{% block extracss %}
<link href="{% static 'create/css/create.css' %}" rel="stylesheet">
{% endblock %}
{% block extrascript %}
<script>
    var assay_mapping = '{% autoescape off %}{{assay_mapping}}{% endautoescape %}';
    if (assay_mapping && assay_mapping.length > 0) {
        assay_mapping = JSON.parse(assay_mapping);
    }
    var uploadURL="{% url 'create.upload' %}";
</script>
<script src="{% static 'create/js/knockoutjs/knockout-2.2.1.js' %}"></script>
<script src="{% static 'create/js/jquery/jquery.validate.min.js' %}"></script>
<script src="{% static 'create/js/study_contacts_model.js' %}"></script>
<script src="{% static 'create/js/study_assays_model.js' %}"></script>
<script src="{% static 'create/js/study_factors_model.js' %}"></script>
<script src="{% static 'create/js/study_protocols_model.js' %}"></script>
<script src="{% static 'create/js/study_publications_model.js' %}"></script>
<script src="{% static 'create/js/study_model.js' %}"></script>
<script src="{% static 'create/js/view_model.js' %}"></script>
<script src="{% static 'create/js/create.js' %}"></script>
{% endblock %}
{% block title %}BII | Create{% endblock %}
{% block content %}
<div id="upload-container">
    <h2>Create ISA-Tab</h2>

    <p id="num_of_studies"><span data-bind='text: studies().length'>&nbsp;</span> study(s) added</p>

    <div class='study_edit'>
        <form id="createISAForm">
            <div class="tabbable tabs-left">
                <ul id="studies_tab" class="nav nav-tabs" data-bind="foreach:studies">
                    <li data-bind="attr: {class:$index()===0 ? 'active' : ''}">
                        <a data-bind="attr: { href:'#study_tab' + ($index()+1)}" data-toggle="tab">
                            <!-- ko if: ($index() !== 0) -->
                            <img data-bind='click: $parent.removeStudy' src="/bii_webapp/static/base/img/basket_x.png"
                                 onclick="javascript:selectDefaultStudy(this)">
                            <!-- /ko -->
                            Study <span data-bind="text: ($index()+1)"></span></a></li>
                    <!-- ko if: ($index() === ($parent.studies().length - 1)) -->
                    <li class="add_item"><a href="#" data-bind='click: $parent.addStudy' data-toggle="tab">+</a></li>
                    <!-- /ko -->
                </ul>
                <div class="tab-content">
                    <!-- ko foreach: studies -->
                    <div class="tab-pane active"
                         data-bind="attr: { id:'study_tab'+($index()+1),class:$parent.studies().length==1 || $index()===0 ? 'tab-pane active' : 'tab-pane'} ">
                        {% include "study_template.html" %}
                    </div>
                    <!-- /ko -->
                </div>
                <div class="upload_button"><button class="btn btn-info" data-bind='enable: studies().length > 0' type="submit">Upload</button></div>
            </div>
        </form>

    </div>

</div>
{% endblock %}